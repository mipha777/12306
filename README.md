# 项目名称
## 12306抢票
- 版本1.0
- 环境：python3.12
- 技术：requests直接请求购票接口，减去使用自动化浏览器的网页信息加载时间
- 2025-7-25
## 目录
## 使用说明
- 因为12306政策调整 现在不能自动登录 必须配合验证码或手机扫码。 所以本程序需要手动登录
- 下载全部文件，按照requirements.txt文件内容下载必要的环境
- 提前在cinfig.yaml配置文件内填写自己的信息 不需要身份证手机号 
- 程序使用前，确保手机12306上乘车人的信息已经添加到乘车人里面认证了(如果需要自动添加，后面会加上此功能)
- 根据个人经验12306的登录信息大约十分钟失效，因此填写玩配置信息后，等到开抢前3-5分钟运行，前面将配置参数填写
- 启动main文件，自动创建临时浏览器，并进入12306登录页面。手动登录(推荐扫码)
- 抢票成功后检查自己手机12306未支付订单
- 目前自测最快抢票时间为0.6秒
## 技术方法
- playwright 自动启动浏览器，用于登录
- request 用于查票和购票接口，减去浏览器的无用信息加载
- httpx 用于初始化订单、乘车人信息验证、订单检查、抢票等接口(反爬严重、技术难点)
## 当前限制
- 有需要的话会添加图形界面，封装成程序运行
- 仅适用于单人抢票(多人可以试着多开或多台电脑)
- 不适配残疾和军人等特殊情况(有需要会添加)
- 不适配选靠窗或上下铺(后续有需要会更新，不过感觉有票就已经很好了，没人抢的票才会想着靠窗，温饱思淫欲)
## 结构
- core
  - buy_ticket 核心逻辑 用于访问各种接口和抢票
  - check_ticket 筛选查到的车辆信息 找出符合要求的
  - login_handler 处理验证码信息（已经弃用，可忽略）
  - look_ticket 查票 并解析字符串 获取座位余票和参数
  - session_manager 管理网络请求，这个总感觉不实用 尤其是12306
  - user_info 从已经认证的乘车人中找到配置中的信息 并返回重要参数
- data
  - seat_types 座位对应关系 密码本
  - station_name_map 车站三字码
- log
  - 日志文件
- utils
  - clean_cookies 清理cookie和临时浏览器
  - cookie_manager 保存和管理cookie
  - get_nested_value 获取车站对应的三字码
  - headers_utils 动态请求头(因为反爬严重，并不实用) 加工cookie
  - logger 日志工具
  - token_parser 解析买票的必要参数
- config.yaml 配置文件 填写目标车辆、日期、开售时间等
- login 生成浏览器 登录
- main 运行主程序
- query_ticket (旧查票方法 弃用)
- requirements 程序所用到的依赖库
 
